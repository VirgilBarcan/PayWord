# PayWord
This is my Information Security project
It models a PayWord protocol, as described in docs/RS96a.prepub.pdf.

For this project, the SHA-1 hash function will be used; SHA-1 "digests" messages and outputs 180 bits.
The messages are signed using RSA digital signature.

The identities of the Broker, User and Vendor are their email addresses, represented on 1024 bits;
Each key has a length of 1024 bits.
The expire date is stored as a long value, as given by Java's Date class, therefore another 64 bits.
The other info: account no, credit limit, etc. will be stored as long values, each of 64 bits.

The steps to be taken:
##1. Registration:
    A. User sends to Broker: his identity, his public key, his account no and credit limit.
    B. Broker sends to User: the certificate: C(U) = sigB(B, U, KB, KU, E, I), where
        B is the identity of the Broker,
        U is the identity of the User,
        KB is the public key of the Broker,
        KU is the public key of the User
        E is the expire date of the certificate,
        I are the additional information: account no, credit limit.

##2. Payment:
    If the User makes his first payment to the Vendor:
        User generates a hash chain of length n: generates cn, an random secret (number), then c(n-1) = h(cn) and so on until c0 = h(c1)
        User computes a commitment: commit(V) = sigU(V, C(U), c0, D, I), where
            V is the identity of the Vendor,
            C(U) is the certificate of the User, generated by the Broker,
            c0 is the root of the hash chain,
            D is the current date,
            I are additional info: length of the chain, etc.
        User sends the commit to the Vendor.
    User sends the i-th payment of the day to the Vendor by sending the pair (ci, i).
##3. Redeem:
    Considering (cl, l) the last payment pair, the Vendor send to the Broker a message containing: commit(U), cl, l.